<div class="widget">
  <div class="title">Twitch Stream Monitor</div>
  <div class="controls">
    <div class="dropdown">
      <a id="TVMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
        <span class="glyphicon glyphicon-option-vertical text-muted"></span>
      </a>
      <ul class="dropdown-menu" aria-labelledby="TVMenu">
        <li><a href="#" onclick="deleteWidget('twitch')" style="color: #a94442;">Delete widget</a></li>
      </ul>
    </div>
  </div>
  <div id="twitchVideoWidget"></div>
</div>

<script>
  $.getScript("http://player.twitch.tv/js/embed/v1.js", function() {
    socket.emit('getTwitchVideo')
  });

  socket.off('twitchVideo')
  socket.on('twitchVideo', function(room) {
    $("#twitchVideoWidget").empty()
    var player = new Twitch.Player("twitchVideoWidget", {width: "100%", channel: room})
    player.addEventListener(Twitch.Player.ONLINE, function () {
      player.play()
    })
  })
</script>