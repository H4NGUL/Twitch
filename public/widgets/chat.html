<div class="widget">
  <div class="title">Twitch Chat</div>
  <div class="controls">
    <div class="dropdown">
      <a data-id="chatWidget" onclick="commons.minimize(this)"><span class="glyphicon glyphicon-resize-small text-muted"></span></a>
      <a id="ChatMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
        <span class="glyphicon glyphicon-option-vertical text-muted"></span>
      </a>
      <ul class="dropdown-menu" aria-labelledby="ChatMenu">
        <li><a href="#" onclick="deleteWidget('chat')" style="color: #a94442;">Delete widget</a></li>
      </ul>
    </div>
  </div>
  <div id="chatWidget"></div>
</div>

<script>
  if (loadedJS.indexOf('chat') === -1) {
    loadedJS.push('chat')
    socket.emit('getChatRoom');
    socket.on('chatRoom', function(room) {
      $("#chatWidget").html('<iframe frameborder="0" scrolling="no" src="http://twitch.tv/' + room + '/chat?popout=" width="100%"></iframe>')
    })
  }
</script>